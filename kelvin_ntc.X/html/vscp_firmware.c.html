<HTML>
<HEAD>
<TITLE>Listing of ../../vscp_firmware/common/vscp_firmware.c</TITLE>
<LINK rel=stylesheet href="udf_styles.css" type="text/css">
</HEAD>
<BODY>
<table class="">
<tr><td><code><i>     1</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>     2</i> </code></td><td><code>&nbsp //&nbsp File:&nbsp vscp_firmware.c</code></td></tr>
<tr><td><code><i>     3</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>     4</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>     5</i> </code></td><td><code>&nbsp /*&nbsp ******************************************************************************</code></td></tr>
<tr><td><code><i>     6</i> </code></td><td><code>&nbsp &nbsp *&nbsp &nbsp&nbsp&nbsp&nbsp VSCP&nbsp (Very&nbsp Simple&nbsp Control&nbsp Protocol)&nbsp </code></td></tr>
<tr><td><code><i>     7</i> </code></td><td><code>&nbsp &nbsp *&nbsp &nbsp&nbsp&nbsp&nbsp http://www.vscp.org</code></td></tr>
<tr><td><code><i>     8</i> </code></td><td><code>&nbsp &nbsp *</code></td></tr>
<tr><td><code><i>     9</i> </code></td><td><code>&nbsp &nbsp *&nbsp&nbsp Copyright&nbsp (C)&nbsp 1995-2014&nbsp Ake&nbsp Hedman,&nbsp </code></td></tr>
<tr><td><code><i>    10</i> </code></td><td><code>&nbsp &nbsp *&nbsp&nbsp Grodans&nbsp Paradis&nbsp AB,&nbsp&lsaquo  akhe@grodansparadis.com&rsaquo &nbsp </code></td></tr>
<tr><td><code><i>    11</i> </code></td><td><code>&nbsp &nbsp *</code></td></tr>
<tr><td><code><i>    12</i> </code></td><td><code>&nbsp &nbsp *&nbsp This&nbsp software&nbsp is&nbsp provided&nbsp 'as-is',&nbsp without&nbsp any&nbsp express&nbsp or&nbsp implied</code></td></tr>
<tr><td><code><i>    13</i> </code></td><td><code>&nbsp &nbsp *&nbsp warranty.&nbsp&nbsp In&nbsp no&nbsp event&nbsp will&nbsp the&nbsp authors&nbsp be&nbsp held&nbsp liable&nbsp for&nbsp any&nbsp damages</code></td></tr>
<tr><td><code><i>    14</i> </code></td><td><code>&nbsp &nbsp *&nbsp arising&nbsp from&nbsp the&nbsp use&nbsp of&nbsp this&nbsp software.</code></td></tr>
<tr><td><code><i>    15</i> </code></td><td><code>&nbsp &nbsp *</code></td></tr>
<tr><td><code><i>    16</i> </code></td><td><code>&nbsp &nbsp *&nbsp Permission&nbsp is&nbsp granted&nbsp to&nbsp anyone&nbsp to&nbsp use&nbsp this&nbsp software&nbsp for&nbsp any&nbsp purpose,</code></td></tr>
<tr><td><code><i>    17</i> </code></td><td><code>&nbsp &nbsp *&nbsp including&nbsp commercial&nbsp applications,&nbsp and&nbsp to&nbsp alter&nbsp it&nbsp and&nbsp redistribute&nbsp it</code></td></tr>
<tr><td><code><i>    18</i> </code></td><td><code>&nbsp &nbsp *&nbsp freely,&nbsp subject&nbsp to&nbsp the&nbsp following&nbsp restrictions:</code></td></tr>
<tr><td><code><i>    19</i> </code></td><td><code>&nbsp &nbsp *</code></td></tr>
<tr><td><code><i>    20</i> </code></td><td><code>&nbsp &nbsp *&nbsp 1.&nbsp The&nbsp origin&nbsp of&nbsp this&nbsp software&nbsp must&nbsp not&nbsp be&nbsp misrepresented;&nbsp you&nbsp must&nbsp not</code></td></tr>
<tr><td><code><i>    21</i> </code></td><td><code>&nbsp &nbsp *&nbsp&nbsp&nbsp&nbsp claim&nbsp that&nbsp you&nbsp wrote&nbsp the&nbsp original&nbsp software.&nbsp If&nbsp you&nbsp use&nbsp this&nbsp software</code></td></tr>
<tr><td><code><i>    22</i> </code></td><td><code>&nbsp &nbsp *&nbsp&nbsp&nbsp&nbsp in&nbsp a&nbsp product,&nbsp an&nbsp acknowledgement&nbsp in&nbsp the&nbsp product&nbsp documentation&nbsp would&nbsp be</code></td></tr>
<tr><td><code><i>    23</i> </code></td><td><code>&nbsp &nbsp *&nbsp&nbsp&nbsp&nbsp appreciated&nbsp but&nbsp is&nbsp not&nbsp required.</code></td></tr>
<tr><td><code><i>    24</i> </code></td><td><code>&nbsp &nbsp *&nbsp 2.&nbsp Altered&nbsp source&nbsp versions&nbsp must&nbsp be&nbsp plainly&nbsp marked&nbsp as&nbsp such,&nbsp and&nbsp must&nbsp not&nbsp be</code></td></tr>
<tr><td><code><i>    25</i> </code></td><td><code>&nbsp &nbsp *&nbsp&nbsp&nbsp&nbsp misrepresented&nbsp as&nbsp being&nbsp the&nbsp original&nbsp software.</code></td></tr>
<tr><td><code><i>    26</i> </code></td><td><code>&nbsp &nbsp *&nbsp 3.&nbsp This&nbsp notice&nbsp may&nbsp not&nbsp be&nbsp removed&nbsp or&nbsp altered&nbsp from&nbsp any&nbsp source&nbsp distribution.</code></td></tr>
<tr><td><code><i>    27</i> </code></td><td><code>&nbsp &nbsp *&nbsp </code></td></tr>
<tr><td><code><i>    28</i> </code></td><td><code>&nbsp &nbsp *&nbsp&nbsp&nbsp&nbsp&nbsp This&nbsp file&nbsp is&nbsp part&nbsp of&nbsp VSCP&nbsp -&nbsp Very&nbsp Simple&nbsp Control&nbsp Protocol&nbsp &nbsp&nbsp&nbsp&nbsp </code></td></tr>
<tr><td><code><i>    29</i> </code></td><td><code>&nbsp &nbsp *&nbsp&nbsp&nbsp&nbsp&nbsp http://www.vscp.org</code></td></tr>
<tr><td><code><i>    30</i> </code></td><td><code>&nbsp &nbsp *</code></td></tr>
<tr><td><code><i>    31</i> </code></td><td><code>&nbsp &nbsp *&nbsp ******************************************************************************</code></td></tr>
<tr><td><code><i>    32</i> </code></td><td><code>&nbsp &nbsp */</code></td></tr>
<tr><td><code><i>    33</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    34</i> </code></td><td><code>&nbsp #include&nbsp&lsaquo  string.h&rsaquo  </code></td></tr>
<tr><td><code><i>    35</i> </code></td><td><code>&nbsp #include&nbsp&lsaquo  stdlib.h&rsaquo  </code></td></tr>
<tr><td><code><i>    36</i> </code></td><td><code>&nbsp #include&nbsp "vscp_class.h"</code></td></tr>
<tr><td><code><i>    37</i> </code></td><td><code>&nbsp #include&nbsp "vscp_type.h"</code></td></tr>
<tr><td><code><i>    38</i> </code></td><td><code>&nbsp #include&nbsp "vscp_firmware.h"</code></td></tr>
<tr><td><code><i>    39</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    40</i> </code></td><td><code>&nbsp #ifndef&nbsp FALSE</code></td></tr>
<tr><td><code><i>    41</i> </code></td><td><code>&nbsp #define&nbsp FALSE&nbsp&nbsp 0</code></td></tr>
<tr><td><code><i>    42</i> </code></td><td><code>&nbsp #endif</code></td></tr>
<tr><td><code><i>    43</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    44</i> </code></td><td><code>&nbsp #ifndef&nbsp TRUE</code></td></tr>
<tr><td><code><i>    45</i> </code></td><td><code>&nbsp #define&nbsp TRUE&nbsp&nbsp&nbsp !FALSE</code></td></tr>
<tr><td><code><i>    46</i> </code></td><td><code>&nbsp #endif</code></td></tr>
<tr><td><code><i>    47</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    48</i> </code></td><td><code>&nbsp #ifndef&nbsp ON</code></td></tr>
<tr><td><code><i>    49</i> </code></td><td><code>&nbsp #define&nbsp ON&nbsp&nbsp&nbsp&nbsp&nbsp !FALSE</code></td></tr>
<tr><td><code><i>    50</i> </code></td><td><code>&nbsp #endif</code></td></tr>
<tr><td><code><i>    51</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    52</i> </code></td><td><code>&nbsp #ifndef&nbsp OFF</code></td></tr>
<tr><td><code><i>    53</i> </code></td><td><code>&nbsp #define&nbsp OFF&nbsp&nbsp&nbsp&nbsp FALSE</code></td></tr>
<tr><td><code><i>    54</i> </code></td><td><code>&nbsp #endif&nbsp </code></td></tr>
<tr><td><code><i>    55</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    56</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    57</i> </code></td><td><code>&nbsp //&nbsp Globals</code></td></tr>
<tr><td><code><i>    58</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    59</i> </code></td><td><code>&nbsp //&nbsp VSCP&nbsp Data</code></td></tr>
<tr><td><code><i>    60</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_nickname;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp ///&lsaquo &nbsp Node&nbsp nickname</code></td></tr>
<tr><td><code><i>    61</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    62</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_errorcnt;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp VSCP/CAN&nbsp errors</code></td></tr>
<tr><td><code><i>    63</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_alarmstatus;&nbsp&nbsp&nbsp //&nbsp VSCP&nbsp Alarm&nbsp Status</code></td></tr>
<tr><td><code><i>    64</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    65</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_node_state;&nbsp&nbsp&nbsp&nbsp //&nbsp State&nbsp machine&nbsp state</code></td></tr>
<tr><td><code><i>    66</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_node_substate;&nbsp //&nbsp State&nbsp machine&nbsp sub&nbsp state</code></td></tr>
<tr><td><code><i>    67</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    68</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_probe_cnt;&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Number&nbsp of&nbsp timeout&nbsp probes</code></td></tr>
<tr><td><code><i>    69</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    70</i> </code></td><td><code>&nbsp //&nbsp Incoming&nbsp event</code></td></tr>
<tr><td><code><i>    71</i> </code></td><td><code>&nbsp struct&nbsp _imsg&nbsp vscp_imsg;</code></td></tr>
<tr><td><code><i>    72</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    73</i> </code></td><td><code>&nbsp //&nbsp Outgoing&nbsp event</code></td></tr>
<tr><td><code><i>    74</i> </code></td><td><code>&nbsp struct&nbsp _omsg&nbsp vscp_omsg;</code></td></tr>
<tr><td><code><i>    75</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    76</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_probe_address;&nbsp //&nbsp Address&nbsp used&nbsp during&nbsp initialization</code></td></tr>
<tr><td><code><i>    77</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_initledfunc;&nbsp&nbsp&nbsp //&nbsp Init.&nbsp LED&nbsp functionality</code></td></tr>
<tr><td><code><i>    78</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    79</i> </code></td><td><code>&nbsp volatile&nbsp uint16_t&nbsp vscp_timer;&nbsp //&nbsp 1&nbsp ms&nbsp timer&nbsp counter</code></td></tr>
<tr><td><code><i>    80</i> </code></td><td><code>&nbsp //&nbsp&nbsp&nbsp&nbsp&nbsp increase&nbsp externally&nbsp bye&nbsp one&nbsp every&nbsp millisecond</code></td></tr>
<tr><td><code><i>    81</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    82</i> </code></td><td><code>&nbsp volatile&nbsp uint8_t&nbsp vscp_initbtncnt;&nbsp //&nbsp init&nbsp button&nbsp counter</code></td></tr>
<tr><td><code><i>    83</i> </code></td><td><code>&nbsp //&nbsp&nbsp increase&nbsp this&nbsp value&nbsp externally&nbsp by&nbsp one&nbsp each&nbsp millisecond</code></td></tr>
<tr><td><code><i>    84</i> </code></td><td><code>&nbsp //&nbsp&nbsp the&nbsp initbutton&nbsp is&nbsp pressed.&nbsp Set&nbsp to&nbsp zero&nbsp when&nbsp button</code></td></tr>
<tr><td><code><i>    85</i> </code></td><td><code>&nbsp //&nbsp is&nbsp released.</code></td></tr>
<tr><td><code><i>    86</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    87</i> </code></td><td><code>&nbsp volatile&nbsp uint8_t&nbsp vscp_statuscnt;&nbsp //&nbsp status&nbsp LED&nbsp counter</code></td></tr>
<tr><td><code><i>    88</i> </code></td><td><code>&nbsp //&nbsp&nbsp&nbsp&nbsp&nbsp increase&nbsp externally&nbsp bye&nbsp one&nbsp every&nbsp millisecond</code></td></tr>
<tr><td><code><i>    89</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    90</i> </code></td><td><code>&nbsp volatile&nbsp uint16_t&nbsp vscp_configtimer;&nbsp //&nbsp configuration&nbsp timer</code></td></tr>
<tr><td><code><i>    91</i> </code></td><td><code>&nbsp //&nbsp&nbsp&nbsp&nbsp&nbsp increase&nbsp externally&nbsp bye&nbsp one&nbsp every&nbsp millisecond</code></td></tr>
<tr><td><code><i>    92</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    93</i> </code></td><td><code>&nbsp //&nbsp page&nbsp selector</code></td></tr>
<tr><td><code><i>    94</i> </code></td><td><code>&nbsp uint16_t&nbsp vscp_page_select;</code></td></tr>
<tr><td><code><i>    95</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>    96</i> </code></td><td><code>&nbsp //&nbsp The&nbsp GUID&nbsp reset&nbsp is&nbsp used&nbsp when&nbsp the&nbsp VSCP_TYPE_PROTOCOL_RESET_DEVICE</code></td></tr>
<tr><td><code><i>    97</i> </code></td><td><code>&nbsp //&nbsp is&nbsp received.&nbsp Bit&nbsp 4,5,6,7&nbsp is&nbsp set&nbsp for&nbsp each&nbsp received&nbsp frame&nbsp with&nbsp </code></td></tr>
<tr><td><code><i>    98</i> </code></td><td><code>&nbsp //&nbsp GUID&nbsp data.&nbsp Bit&nbsp 4&nbsp is&nbsp for&nbsp index&nbsp =&nbsp 0,&nbsp bit&nbsp 5&nbsp is&nbsp for&nbsp index&nbsp =&nbsp 1&nbsp etc.</code></td></tr>
<tr><td><code><i>    99</i> </code></td><td><code>&nbsp //&nbsp This&nbsp means&nbsp that&nbsp a&nbsp bit&nbsp is&nbsp set&nbsp if&nbsp a&nbsp frame&nbsp with&nbsp correct&nbsp GUID&nbsp is</code></td></tr>
<tr><td><code><i>   100</i> </code></td><td><code>&nbsp //&nbsp received.&nbsp&nbsp </code></td></tr>
<tr><td><code><i>   101</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_guid_reset;</code></td></tr>
<tr><td><code><i>   102</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   103</i> </code></td><td><code>&nbsp //&nbsp Timekeeping</code></td></tr>
<tr><td><code><i>   104</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_second;</code></td></tr>
<tr><td><code><i>   105</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_minute;</code></td></tr>
<tr><td><code><i>   106</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_hour;</code></td></tr>
<tr><td><code><i>   107</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   108</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   109</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   110</i> </code></td><td><code>&nbsp //&nbsp vscp_init</code></td></tr>
<tr><td><code><i>   111</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   112</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   113</i> </code></td><td><code>&nbsp void&nbsp vscp_init(void)</code></td></tr>
<tr><td><code><i>   114</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   115</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_initledfunc&nbsp =&nbsp VSCP_LED_BLINK1;</code></td></tr>
<tr><td><code><i>   116</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   117</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp read&nbsp the&nbsp nickname&nbsp id</code></td></tr>
<tr><td><code><i>   118</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_nickname&nbsp =&nbsp vscp_readNicknamePermanent();</code></td></tr>
<tr><td><code><i>   119</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   120</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp if&nbsp zero&nbsp set&nbsp to&nbsp uninitialized</code></td></tr>
<tr><td><code><i>   121</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (!vscp_nickname)&nbsp vscp_nickname&nbsp =&nbsp VSCP_ADDRESS_FREE;</code></td></tr>
<tr><td><code><i>   122</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   123</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp Init.&nbsp incoming&nbsp event</code></td></tr>
<tr><td><code><i>   124</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_imsg.flags&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   125</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_imsg.priority&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   126</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_imsg.vscp_class&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   127</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_imsg.vscp_type&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   128</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   129</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp Init.&nbsp outgoing&nbsp event</code></td></tr>
<tr><td><code><i>   130</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   131</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   132</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   133</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   134</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   135</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_errorcnt&nbsp =&nbsp 0;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp No&nbsp errors&nbsp yet</code></td></tr>
<tr><td><code><i>   136</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_alarmstatus&nbsp =&nbsp 0;&nbsp&nbsp&nbsp //&nbsp No&nbsp alarm&nbsp status</code></td></tr>
<tr><td><code><i>   137</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   138</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_probe_address&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   139</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   140</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp Initial&nbsp state</code></td></tr>
<tr><td><code><i>   141</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_node_state&nbsp =&nbsp VSCP_STATE_STARTUP;</code></td></tr>
<tr><td><code><i>   142</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_node_substate&nbsp =&nbsp VSCP_SUBSTATE_NONE;</code></td></tr>
<tr><td><code><i>   143</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   144</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_probe_cnt&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   145</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_page_select&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   146</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   147</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp Initialize&nbsp time&nbsp keeping</code></td></tr>
<tr><td><code><i>   148</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_timer&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   149</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_configtimer&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   150</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_second&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   151</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_minute&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   152</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_hour&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   153</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   154</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   155</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   156</i> </code></td><td><code>&nbsp //&nbsp vscp_check_pstorage</code></td></tr>
<tr><td><code><i>   157</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   158</i> </code></td><td><code>&nbsp //&nbsp Check&nbsp control&nbsp position&nbsp integrity&nbsp and&nbsp restore&nbsp EEPROM</code></td></tr>
<tr><td><code><i>   159</i> </code></td><td><code>&nbsp //&nbsp if&nbsp invalid.</code></td></tr>
<tr><td><code><i>   160</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   161</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   162</i> </code></td><td><code>&nbsp int8_t&nbsp vscp_check_pstorage(void)</code></td></tr>
<tr><td><code><i>   163</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   164</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp controlbyte&nbsp ==&nbsp 01xxxxxx&nbsp means&nbsp initialized</code></td></tr>
<tr><td><code><i>   165</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp everything&nbsp else&nbsp is&nbsp uninitialized</code></td></tr>
<tr><td><code><i>   166</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp ((vscp_getSegmentCRC()&nbsp &&nbsp 0xc0)&nbsp ==&nbsp 0x40)&nbsp {</code></td></tr>
<tr><td><code><i>   167</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp return&nbsp TRUE;</code></td></tr>
<tr><td><code><i>   168</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   169</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   170</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp No&nbsp nickname&nbsp yet.</code></td></tr>
<tr><td><code><i>   171</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_writeNicknamePermanent(0xff);</code></td></tr>
<tr><td><code><i>   172</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   173</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp No&nbsp segment&nbsp CRC&nbsp yet.</code></td></tr>
<tr><td><code><i>   174</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_setSegmentCRC(0x00);</code></td></tr>
<tr><td><code><i>   175</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   176</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp Initial&nbsp startup</code></td></tr>
<tr><td><code><i>   177</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp write&nbsp allowed</code></td></tr>
<tr><td><code><i>   178</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_setControlByte(0xA0);</code></td></tr>
<tr><td><code><i>   179</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   180</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp return&nbsp FALSE;</code></td></tr>
<tr><td><code><i>   181</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   182</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   183</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   184</i> </code></td><td><code>&nbsp //&nbsp vscp_error</code></td></tr>
<tr><td><code><i>   185</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   186</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   187</i> </code></td><td><code>&nbsp void&nbsp vscp_error(void)</code></td></tr>
<tr><td><code><i>   188</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   189</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_initledfunc&nbsp =&nbsp VSCP_LED_OFF;</code></td></tr>
<tr><td><code><i>   190</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   191</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   192</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   193</i> </code></td><td><code>&nbsp //&nbsp vscp_handleProbe</code></td></tr>
<tr><td><code><i>   194</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   195</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   196</i> </code></td><td><code>&nbsp void&nbsp vscp_handleProbeState(void)</code></td></tr>
<tr><td><code><i>   197</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   198</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp switch&nbsp (vscp_node_substate)&nbsp {</code></td></tr>
<tr><td><code><i>   199</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   200</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_SUBSTATE_NONE:</code></td></tr>
<tr><td><code><i>   201</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   202</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (VSCP_ADDRESS_FREE&nbsp !=&nbsp vscp_probe_address)&nbsp {</code></td></tr>
<tr><td><code><i>   203</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   204</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 1;&nbsp //&nbsp one&nbsp databyte</code></td></tr>
<tr><td><code><i>   205</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_HIGH;</code></td></tr>
<tr><td><code><i>   206</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>   207</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_NEW_NODE_ONLINE;</code></td></tr>
<tr><td><code><i>   208</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp vscp_probe_address;</code></td></tr>
<tr><td><code><i>   209</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   210</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp the&nbsp probe</code></td></tr>
<tr><td><code><i>   211</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>   212</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   213</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_node_substate&nbsp =&nbsp VSCP_SUBSTATE_INIT_PROBE_SENT;</code></td></tr>
<tr><td><code><i>   214</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_timer&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   215</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   216</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   217</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   218</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp No&nbsp free&nbsp address&nbsp -&rsaquo &nbsp error</code></td></tr>
<tr><td><code><i>   219</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_node_state&nbsp =&nbsp VSCP_STATE_ERROR;</code></td></tr>
<tr><td><code><i>   220</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   221</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Tell&nbsp system&nbsp we&nbsp are&nbsp giving&nbsp up</code></td></tr>
<tr><td><code><i>   222</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 1;&nbsp //&nbsp one&nbsp databyte</code></td></tr>
<tr><td><code><i>   223</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp 0xff;&nbsp //&nbsp we&nbsp are&nbsp unassigned</code></td></tr>
<tr><td><code><i>   224</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_LOW;</code></td></tr>
<tr><td><code><i>   225</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>   226</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_PROBE_ACK;</code></td></tr>
<tr><td><code><i>   227</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   228</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp the&nbsp error&nbsp event</code></td></tr>
<tr><td><code><i>   229</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>   230</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   231</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   232</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   233</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   234</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_SUBSTATE_INIT_PROBE_SENT:</code></td></tr>
<tr><td><code><i>   235</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   236</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_imsg.flags&nbsp &&nbsp VSCP_VALID_MSG)&nbsp {&nbsp //&nbsp incoming&nbsp event?</code></td></tr>
<tr><td><code><i>   237</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   238</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Yes,&nbsp incoming&nbsp event</code></td></tr>
<tr><td><code><i>   239</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((VSCP_CLASS1_PROTOCOL&nbsp ==&nbsp vscp_imsg.vscp_class)&nbsp &&</code></td></tr>
<tr><td><code><i>   240</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (VSCP_TYPE_PROTOCOL_PROBE_ACK&nbsp ==&nbsp vscp_imsg.vscp_type))&nbsp {</code></td></tr>
<tr><td><code><i>   241</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   242</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Yes&nbsp it&nbsp was&nbsp an&nbsp ack&nbsp from&nbsp the&nbsp segment&nbsp master&nbsp or&nbsp a&nbsp node</code></td></tr>
<tr><td><code><i>   243</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (0&nbsp ==&nbsp vscp_probe_address)&nbsp {</code></td></tr>
<tr><td><code><i>   244</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   245</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Master&nbsp controller&nbsp answered</code></td></tr>
<tr><td><code><i>   246</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp wait&nbsp for&nbsp address</code></td></tr>
<tr><td><code><i>   247</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_node_state&nbsp =&nbsp VSCP_STATE_PREACTIVE;</code></td></tr>
<tr><td><code><i>   248</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_timer&nbsp =&nbsp 0;&nbsp //&nbsp reset&nbsp timer</code></td></tr>
<tr><td><code><i>   249</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   250</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   251</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   252</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp node&nbsp answered,&nbsp try&nbsp next&nbsp address</code></td></tr>
<tr><td><code><i>   253</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_probe_address++;</code></td></tr>
<tr><td><code><i>   254</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_node_substate&nbsp =&nbsp VSCP_SUBSTATE_NONE;</code></td></tr>
<tr><td><code><i>   255</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_probe_cnt&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   256</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   257</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   258</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   259</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   260</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   261</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_timer&nbsp&rsaquo &nbsp VSCP_PROBE_TIMEOUT)&nbsp {&nbsp //&nbsp Check&nbsp for&nbsp timeout</code></td></tr>
<tr><td><code><i>   262</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   263</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_probe_cnt++;&nbsp //&nbsp Another&nbsp timeout</code></td></tr>
<tr><td><code><i>   264</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   265</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_probe_cnt&nbsp&rsaquo  =&nbsp VSCP_PROBE_TIMEOUT_COUNT)&nbsp {</code></td></tr>
<tr><td><code><i>   266</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   267</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Yes&nbsp we&nbsp have&nbsp a&nbsp timeout</code></td></tr>
<tr><td><code><i>   268</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (0&nbsp ==&nbsp vscp_probe_address)&nbsp {&nbsp //&nbsp master&nbsp controller&nbsp probe?</code></td></tr>
<tr><td><code><i>   269</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   270</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp No&nbsp master&nbsp controler&nbsp on&nbsp segment,&nbsp try&nbsp next&nbsp node</code></td></tr>
<tr><td><code><i>   271</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_probe_address++;</code></td></tr>
<tr><td><code><i>   272</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_node_substate&nbsp =&nbsp VSCP_SUBSTATE_NONE;</code></td></tr>
<tr><td><code><i>   273</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_timer&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   274</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_probe_cnt&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   275</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   276</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   277</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   278</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp We&nbsp have&nbsp found&nbsp a&nbsp free&nbsp address&nbsp -&nbsp use&nbsp it</code></td></tr>
<tr><td><code><i>   279</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_nickname&nbsp =&nbsp vscp_probe_address;</code></td></tr>
<tr><td><code><i>   280</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_node_state&nbsp =&nbsp VSCP_STATE_ACTIVE;</code></td></tr>
<tr><td><code><i>   281</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_node_substate&nbsp =&nbsp VSCP_SUBSTATE_NONE;</code></td></tr>
<tr><td><code><i>   282</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_writeNicknamePermanent(vscp_nickname);</code></td></tr>
<tr><td><code><i>   283</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_setSegmentCRC(0x40);&nbsp //&nbsp segment&nbsp code&nbsp (non&nbsp server&nbsp segment&nbsp )</code></td></tr>
<tr><td><code><i>   284</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   285</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Report&nbsp success</code></td></tr>
<tr><td><code><i>   286</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_probe_cnt&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   287</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_goActiveState();</code></td></tr>
<tr><td><code><i>   288</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   289</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   290</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   291</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_node_substate&nbsp =&nbsp VSCP_SUBSTATE_NONE;</code></td></tr>
<tr><td><code><i>   292</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   293</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp //&nbsp Timeout</code></td></tr>
<tr><td><code><i>   294</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   295</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   296</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   297</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   298</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_SUBSTATE_INIT_PROBE_ACK:</code></td></tr>
<tr><td><code><i>   299</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   300</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   301</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp default:</code></td></tr>
<tr><td><code><i>   302</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_node_substate&nbsp =&nbsp VSCP_SUBSTATE_NONE;</code></td></tr>
<tr><td><code><i>   303</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   304</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   305</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   306</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_imsg.flags&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   307</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   308</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   309</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   310</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   311</i> </code></td><td><code>&nbsp //&nbsp vscp_handlePreActiveState</code></td></tr>
<tr><td><code><i>   312</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   313</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   314</i> </code></td><td><code>&nbsp void&nbsp vscp_handlePreActiveState(void)</code></td></tr>
<tr><td><code><i>   315</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   316</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   317</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp vscp_imsg.flags&nbsp &&nbsp VSCP_VALID_MSG&nbsp )&nbsp {&nbsp //&nbsp incoming&nbsp event?</code></td></tr>
<tr><td><code><i>   318</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   319</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((VSCP_CLASS1_PROTOCOL&nbsp ==&nbsp vscp_imsg.vscp_class)&nbsp &&</code></td></tr>
<tr><td><code><i>   320</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (VSCP_TYPE_PROTOCOL_SET_NICKNAME&nbsp ==&nbsp vscp_imsg.vscp_type)&nbsp &&</code></td></tr>
<tr><td><code><i>   321</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (VSCP_ADDRESS_FREE&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   322</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   323</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Assign&nbsp nickname</code></td></tr>
<tr><td><code><i>   324</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_nickname&nbsp =&nbsp vscp_imsg.data[&nbsp 1&nbsp ];</code></td></tr>
<tr><td><code><i>   325</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_writeNicknamePermanent(vscp_nickname);</code></td></tr>
<tr><td><code><i>   326</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_setSegmentCRC(0x40);</code></td></tr>
<tr><td><code><i>   327</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   328</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Go&nbsp active&nbsp state</code></td></tr>
<tr><td><code><i>   329</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_node_state&nbsp =&nbsp VSCP_STATE_ACTIVE;</code></td></tr>
<tr><td><code><i>   330</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   331</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   332</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Check&nbsp for&nbsp time&nbsp out</code></td></tr>
<tr><td><code><i>   333</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_timer&nbsp&rsaquo &nbsp VSCP_PROBE_TIMEOUT)&nbsp {</code></td></tr>
<tr><td><code><i>   334</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Yes,&nbsp we&nbsp have&nbsp a&nbsp timeout</code></td></tr>
<tr><td><code><i>   335</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_nickname&nbsp =&nbsp VSCP_ADDRESS_FREE;</code></td></tr>
<tr><td><code><i>   336</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_writeNicknamePermanent(VSCP_ADDRESS_FREE);</code></td></tr>
<tr><td><code><i>   337</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_init();</code></td></tr>
<tr><td><code><i>   338</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   339</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   340</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   341</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   342</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   343</i> </code></td><td><code>&nbsp //&nbsp vscp_goActiveState</code></td></tr>
<tr><td><code><i>   344</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   345</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   346</i> </code></td><td><code>&nbsp void&nbsp vscp_goActiveState(void)</code></td></tr>
<tr><td><code><i>   347</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   348</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 1;&nbsp //&nbsp one&nbsp databyte</code></td></tr>
<tr><td><code><i>   349</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_HIGH;</code></td></tr>
<tr><td><code><i>   350</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>   351</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_NEW_NODE_ONLINE;</code></td></tr>
<tr><td><code><i>   352</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp vscp_nickname;</code></td></tr>
<tr><td><code><i>   353</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   354</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp the&nbsp event</code></td></tr>
<tr><td><code><i>   355</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>   356</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   357</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_initledfunc&nbsp =&nbsp VSCP_LED_ON;</code></td></tr>
<tr><td><code><i>   358</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   359</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   360</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   361</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   362</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   363</i> </code></td><td><code>&nbsp //&nbsp vscp_sendHeartbeat</code></td></tr>
<tr><td><code><i>   364</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   365</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   366</i> </code></td><td><code>&nbsp void&nbsp vscp_sendHeartBeat(uint8_t&nbsp zone,&nbsp uint8_t&nbsp subzone)</code></td></tr>
<tr><td><code><i>   367</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   368</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 3;&nbsp //&nbsp three&nbsp databyte</code></td></tr>
<tr><td><code><i>   369</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_LOW;</code></td></tr>
<tr><td><code><i>   370</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_INFORMATION;</code></td></tr>
<tr><td><code><i>   371</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_INFORMATION_NODE_HEARTBEAT;</code></td></tr>
<tr><td><code><i>   372</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   373</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 1&nbsp ]&nbsp =&nbsp zone;</code></td></tr>
<tr><td><code><i>   374</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 2&nbsp ]&nbsp =&nbsp subzone;</code></td></tr>
<tr><td><code><i>   375</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   376</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp the&nbsp event</code></td></tr>
<tr><td><code><i>   377</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>   378</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   379</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   380</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   381</i> </code></td><td><code>&nbsp //&nbsp vscp_handleHeartbeat</code></td></tr>
<tr><td><code><i>   382</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   383</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   384</i> </code></td><td><code>&nbsp void&nbsp vscp_handleHeartbeat(void)</code></td></tr>
<tr><td><code><i>   385</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   386</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp !vscp_getSegmentCRC()&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>   387</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp (&nbsp 5&nbsp ==&nbsp (vscp_imsg.flags&nbsp &&nbsp 0x0f&nbsp )&nbsp )&nbsp &&</code></td></tr>
<tr><td><code><i>   388</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getSegmentCRC()&nbsp !=&nbsp vscp_imsg.data[&nbsp 0&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   389</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   390</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Stored&nbsp CRC&nbsp are&nbsp different&nbsp than&nbsp received</code></td></tr>
<tr><td><code><i>   391</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp We&nbsp must&nbsp be&nbsp on&nbsp a&nbsp different&nbsp segment</code></td></tr>
<tr><td><code><i>   392</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_setSegmentCRC(vscp_imsg.data[&nbsp 0&nbsp ]);</code></td></tr>
<tr><td><code><i>   393</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   394</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Introduce&nbsp ourself&nbsp in&nbsp the&nbsp proper&nbsp way&nbsp and&nbsp start&nbsp from&nbsp the&nbsp beginning</code></td></tr>
<tr><td><code><i>   395</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_nickname&nbsp =&nbsp VSCP_ADDRESS_FREE;</code></td></tr>
<tr><td><code><i>   396</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_writeNicknamePermanent(VSCP_ADDRESS_FREE);</code></td></tr>
<tr><td><code><i>   397</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_node_state&nbsp =&nbsp VSCP_STATE_INIT;</code></td></tr>
<tr><td><code><i>   398</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   399</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   400</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   401</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp First&nbsp heartbeat&nbsp seen&nbsp by&nbsp this&nbsp node</code></td></tr>
<tr><td><code><i>   402</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_setSegmentCRC(vscp_imsg.data[&nbsp 0&nbsp ]);</code></td></tr>
<tr><td><code><i>   403</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   404</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   405</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   406</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   407</i> </code></td><td><code>&nbsp //&nbsp vscp_handleSetNickname</code></td></tr>
<tr><td><code><i>   408</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   409</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   410</i> </code></td><td><code>&nbsp void&nbsp vscp_handleSetNickname(void)</code></td></tr>
<tr><td><code><i>   411</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   412</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp ((2&nbsp ==&nbsp (vscp_imsg.flags&nbsp &&nbsp 0x0f))&nbsp &&</code></td></tr>
<tr><td><code><i>   413</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   414</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   415</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Yes,&nbsp we&nbsp are&nbsp addressed</code></td></tr>
<tr><td><code><i>   416</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_nickname&nbsp =&nbsp vscp_imsg.data[&nbsp 1&nbsp ];</code></td></tr>
<tr><td><code><i>   417</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_writeNicknamePermanent(vscp_nickname);</code></td></tr>
<tr><td><code><i>   418</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_setSegmentCRC(0x40);</code></td></tr>
<tr><td><code><i>   419</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   420</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   421</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   422</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   423</i> </code></td><td><code>&nbsp //&nbsp vscp_handleDropNickname</code></td></tr>
<tr><td><code><i>   424</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   425</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   426</i> </code></td><td><code>&nbsp void&nbsp vscp_handleDropNickname(void)</code></td></tr>
<tr><td><code><i>   427</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   428</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp bytes&nbsp =&nbsp vscp_imsg.flags&nbsp &&nbsp 0x0f;</code></td></tr>
<tr><td><code><i>   429</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   430</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp #ifdef&nbsp DROP_NICKNAME_EXTENDED_FEATURES</code></td></tr>
<tr><td><code><i>   431</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp brake&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   432</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp #endif</code></td></tr>
<tr><td><code><i>   433</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp </code></td></tr>
<tr><td><code><i>   434</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp ((bytes&nbsp&rsaquo  =&nbsp 1)&nbsp &&&nbsp (vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   435</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Yes,&nbsp we&nbsp are&nbsp addressed</code></td></tr>
<tr><td><code><i>   436</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   437</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp #ifdef&nbsp DROP_NICKNAME_EXTENDED_FEATURES</code></td></tr>
<tr><td><code><i>   438</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Optional&nbsp Byte&nbsp 1:&nbsp </code></td></tr>
<tr><td><code><i>   439</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp bit7&nbsp -&nbsp go&nbsp idle&nbsp do&nbsp not&nbsp start,&nbsp bit6&nbsp -&nbsp reset&nbsp persistent&nbsp storage</code></td></tr>
<tr><td><code><i>   440</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp bit5&nbsp -&nbsp reset&nbsp device&nbsp but&nbsp keep&nbsp nickname</code></td></tr>
<tr><td><code><i>   441</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp bit5&nbsp and&nbsp bit&nbsp 7&nbsp are&nbsp concurrent,&nbsp here&nbsp I&nbsp give&nbsp bit&nbsp 5&nbsp higher&nbsp priority</code></td></tr>
<tr><td><code><i>   442</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Optional&nbsp byte&nbsp 2:&nbsp time&nbsp in&nbsp seconds&nbsp before&nbsp restarting&nbsp (makes&nbsp only&nbsp sense</code></td></tr>
<tr><td><code><i>   443</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp with&nbsp either&nbsp none&nbsp of&nbsp the&nbsp bits&nbsp or&nbsp only&nbsp bit&nbsp 5&nbsp of&nbsp byte1&nbsp set.</code></td></tr>
<tr><td><code><i>   444</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (bytes&nbsp&rsaquo  =&nbsp 2)&nbsp {&nbsp&nbsp //&nbsp byte&nbsp 1&nbsp does&nbsp exist</code></td></tr>
<tr><td><code><i>   445</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp bit&nbsp 6&nbsp set:&nbsp reset&nbsp persistent&nbsp storage,&nbsp continue&nbsp to&nbsp check&nbsp other</code></td></tr>
<tr><td><code><i>   446</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp options&nbsp in&nbsp byte&nbsp 1</code></td></tr>
<tr><td><code><i>   447</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_imsg.data[1]&nbsp &&nbsp (1&lsaquo &lsaquo  6))&nbsp {</code></td></tr>
<tr><td><code><i>   448</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp reset&nbsp persistant&nbsp storage&nbsp here</code></td></tr>
<tr><td><code><i>   449</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   450</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp bit&nbsp 5&nbsp set:&nbsp reset&nbsp device,&nbsp keep&nbsp nickname,&nbsp disregard&nbsp other&nbsp option</code></td></tr>
<tr><td><code><i>   451</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp below&nbsp this&nbsp by&nbsp using&nbsp 'brake'</code></td></tr>
<tr><td><code><i>   452</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((vscp_imsg.data[1]&nbsp &&nbsp (1&lsaquo &lsaquo  5))&nbsp &&&nbsp (brake&nbsp ==&nbsp 0))&nbsp {</code></td></tr>
<tr><td><code><i>   453</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_hardreset();</code></td></tr>
<tr><td><code><i>   454</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp brake&nbsp =&nbsp 1;}</code></td></tr>
<tr><td><code><i>   455</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   456</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp bit&nbsp 7&nbsp set:&nbsp go&nbsp idle,&nbsp e.g.&nbsp stay&nbsp in&nbsp an&nbsp endless&nbsp loop&nbsp until&nbsp repower</code></td></tr>
<tr><td><code><i>   457</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((vscp_imsg.data[1]&nbsp &&nbsp (1&lsaquo &lsaquo  7))&nbsp &&&nbsp (brake&nbsp ==&nbsp 0))&nbsp {&nbsp </code></td></tr>
<tr><td><code><i>   458</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_nickname&nbsp =&nbsp VSCP_ADDRESS_FREE;</code></td></tr>
<tr><td><code><i>   459</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_writeNicknamePermanent(VSCP_ADDRESS_FREE);</code></td></tr>
<tr><td><code><i>   460</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp for&nbsp (;;)&nbsp {};&nbsp //&nbsp wait&nbsp forever</code></td></tr>
<tr><td><code><i>   461</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   462</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   463</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp #endif</code></td></tr>
<tr><td><code><i>   464</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp none&nbsp of&nbsp the&nbsp options&nbsp from&nbsp byte&nbsp 1&nbsp have&nbsp been&nbsp used&nbsp or&nbsp byte&nbsp 1&nbsp itself</code></td></tr>
<tr><td><code><i>   465</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp has&nbsp not&nbsp been&nbsp transmitted&nbsp at&nbsp all</code></td></tr>
<tr><td><code><i>   466</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((bytes&nbsp ==&nbsp 1)&nbsp ||&nbsp ((bytes&nbsp&rsaquo &nbsp 1)&nbsp &&&nbsp (vscp_imsg.data[1]&nbsp ==&nbsp 0)))&nbsp {</code></td></tr>
<tr><td><code><i>   467</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp this&nbsp is&nbsp the&nbsp regular&nbsp behavior&nbsp without&nbsp using&nbsp byte&nbsp 1&nbsp options</code></td></tr>
<tr><td><code><i>   468</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_nickname&nbsp =&nbsp VSCP_ADDRESS_FREE;</code></td></tr>
<tr><td><code><i>   469</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_writeNicknamePermanent(VSCP_ADDRESS_FREE);</code></td></tr>
<tr><td><code><i>   470</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_init();</code></td></tr>
<tr><td><code><i>   471</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   472</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp #ifdef&nbsp DROP_NICKNAME_EXTENDED_FEATURES</code></td></tr>
<tr><td><code><i>   473</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp now&nbsp check&nbsp if&nbsp timing&nbsp was&nbsp passed&nbsp in&nbsp byte&nbsp 2</code></td></tr>
<tr><td><code><i>   474</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (bytes&nbsp&rsaquo &nbsp 2)&nbsp {</code></td></tr>
<tr><td><code><i>   475</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp and&nbsp waiting&nbsp for&nbsp options&nbsp that&nbsp made&nbsp sense</code></td></tr>
<tr><td><code><i>   476</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp (vscp_imsg.data[1]&nbsp ==&nbsp 0)&nbsp ||&nbsp (&nbsp vscp_imsg.data[1]&nbsp &&nbsp (1&lsaquo &lsaquo  6))&nbsp ||</code></td></tr>
<tr><td><code><i>   477</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (&nbsp vscp_imsg.data[1]&nbsp &&nbsp (1&lsaquo &lsaquo  5))&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>   478</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp wait&nbsp platform&nbsp independently</code></td></tr>
<tr><td><code><i>   479</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_wait_s(vscp_imsg.data[2]);</code></td></tr>
<tr><td><code><i>   480</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   481</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   482</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp #endif</code></td></tr>
<tr><td><code><i>   483</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   484</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   485</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   486</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   487</i> </code></td><td><code>&nbsp //&nbsp vscp_newNodeOnline</code></td></tr>
<tr><td><code><i>   488</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   489</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   490</i> </code></td><td><code>&nbsp void&nbsp vscp_newNodeOnline(void)</code></td></tr>
<tr><td><code><i>   491</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   492</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp ((1&nbsp ==&nbsp (vscp_imsg.flags&nbsp &&nbsp 0x0f))&nbsp &&</code></td></tr>
<tr><td><code><i>   493</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   494</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   495</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp This&nbsp is&nbsp a&nbsp probe&nbsp which&nbsp use&nbsp our&nbsp nickname</code></td></tr>
<tr><td><code><i>   496</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp we&nbsp have&nbsp to&nbsp respond&nbsp to&nbsp tell&nbsp the&nbsp new&nbsp node&nbsp that</code></td></tr>
<tr><td><code><i>   497</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp ths&nbsp nickname&nbsp is&nbsp in&nbsp use</code></td></tr>
<tr><td><code><i>   498</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   499</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG;</code></td></tr>
<tr><td><code><i>   500</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_HIGH;</code></td></tr>
<tr><td><code><i>   501</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>   502</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_PROBE_ACK;</code></td></tr>
<tr><td><code><i>   503</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>   504</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   505</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   506</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   507</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   508</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   509</i> </code></td><td><code>&nbsp //&nbsp vscp_doOneSecondWork</code></td></tr>
<tr><td><code><i>   510</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   511</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   512</i> </code></td><td><code>&nbsp void&nbsp vscp_doOneSecondWork(void)</code></td></tr>
<tr><td><code><i>   513</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   514</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   515</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp ++vscp_second;</code></td></tr>
<tr><td><code><i>   516</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   517</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_second&nbsp&rsaquo &nbsp 59)&nbsp {</code></td></tr>
<tr><td><code><i>   518</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_second&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   519</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_minute++;</code></td></tr>
<tr><td><code><i>   520</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   521</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp periodic&nbsp heartbeat</code></td></tr>
<tr><td><code><i>   522</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (VSCP_STATE_ACTIVE&nbsp ==&nbsp vscp_node_state)&nbsp {</code></td></tr>
<tr><td><code><i>   523</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendHeartBeat(vscp_getZone(),</code></td></tr>
<tr><td><code><i>   524</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_getSubzone());</code></td></tr>
<tr><td><code><i>   525</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   526</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   527</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   528</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_minute&nbsp&rsaquo &nbsp 59)&nbsp {</code></td></tr>
<tr><td><code><i>   529</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_minute&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   530</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_hour++;</code></td></tr>
<tr><td><code><i>   531</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   532</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   533</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_hour&nbsp&rsaquo &nbsp 23)&nbsp vscp_hour&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   534</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   535</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp See&nbsp declaration&nbsp of&nbsp vscp_guid_reset</code></td></tr>
<tr><td><code><i>   536</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   537</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (VSCP_STATE_ACTIVE&nbsp ==&nbsp vscp_node_state)&nbsp {</code></td></tr>
<tr><td><code><i>   538</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_guid_reset++;</code></td></tr>
<tr><td><code><i>   539</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((vscp_guid_reset&nbsp &&nbsp 0x0f)&nbsp&rsaquo  =&nbsp 2)&nbsp {</code></td></tr>
<tr><td><code><i>   540</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_guid_reset&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   541</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   542</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   543</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   544</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   545</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   546</i> </code></td><td><code>&nbsp //&nbsp vscp_readRegister</code></td></tr>
<tr><td><code><i>   547</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   548</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   549</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_readRegister(uint8_t&nbsp reg)</code></td></tr>
<tr><td><code><i>   550</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   551</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (reg&nbsp&rsaquo  =&nbsp 0x80)&nbsp {</code></td></tr>
<tr><td><code><i>   552</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp return&nbsp vscp_readStdReg(reg);</code></td></tr>
<tr><td><code><i>   553</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   554</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp return&nbsp vscp_readAppReg(reg);</code></td></tr>
<tr><td><code><i>   555</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   556</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   557</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   558</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   559</i> </code></td><td><code>&nbsp //&nbsp vscp_readStdReg</code></td></tr>
<tr><td><code><i>   560</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   561</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   562</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_readStdReg(uint8_t&nbsp reg)</code></td></tr>
<tr><td><code><i>   563</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   564</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp uint8_t&nbsp rv&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   565</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   566</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (VSCP_REG_ALARMSTATUS&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   567</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   568</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Read&nbsp alarm&nbsp status&nbsp register&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   569</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_alarmstatus;</code></td></tr>
<tr><td><code><i>   570</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_alarmstatus&nbsp =&nbsp 0x00;&nbsp //&nbsp Reset&nbsp alarm&nbsp status</code></td></tr>
<tr><td><code><i>   571</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   572</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   573</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_VSCP_MAJOR_VERSION&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   574</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   575</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp VSCP&nbsp Protocol&nbsp Major&nbsp Version&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   576</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp VSCP_MAJOR_VERSION;</code></td></tr>
<tr><td><code><i>   577</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   578</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   579</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_VSCP_MINOR_VERSION&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   580</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   581</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp VSCP&nbsp Protocol&nbsp Minor&nbsp Version&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   582</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp VSCP_MINOR_VERSION;</code></td></tr>
<tr><td><code><i>   583</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   584</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   585</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_NODE_CONTROL&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   586</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   587</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Reserved&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   588</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   589</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   590</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   591</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_FIRMWARE_MAJOR_VERSION&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   592</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   593</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Get&nbsp firmware&nbsp Major&nbsp version&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   594</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getMajorVersion();</code></td></tr>
<tr><td><code><i>   595</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   596</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   597</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_FIRMWARE_MINOR_VERSION&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   598</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   599</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Get&nbsp firmware&nbsp Minor&nbsp version&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   600</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getMinorVersion();</code></td></tr>
<tr><td><code><i>   601</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   602</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   603</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_FIRMWARE_SUB_MINOR_VERSION&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   604</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   605</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Get&nbsp firmware&nbsp Sub&nbsp Minor&nbsp version&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   606</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getSubMinorVersion();</code></td></tr>
<tr><td><code><i>   607</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   608</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   609</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (reg&nbsp&lsaquo &nbsp VSCP_REG_MANUFACTUR_ID0)&nbsp {</code></td></tr>
<tr><td><code><i>   610</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   611</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Read&nbsp from&nbsp persitant&nbsp locations&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   612</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getUserID(reg&nbsp -&nbsp VSCP_REG_USERID0);</code></td></tr>
<tr><td><code><i>   613</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   614</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   615</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp ((reg&nbsp&rsaquo &nbsp VSCP_REG_USERID4)&nbsp &&</code></td></tr>
<tr><td><code><i>   616</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (reg&nbsp&lsaquo &nbsp VSCP_REG_NICKNAME_ID))&nbsp {</code></td></tr>
<tr><td><code><i>   617</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   618</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Manufacturer&nbsp ID&nbsp information&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   619</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getManufacturerId(reg&nbsp -&nbsp VSCP_REG_MANUFACTUR_ID0);</code></td></tr>
<tr><td><code><i>   620</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   621</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   622</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_NICKNAME_ID&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   623</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   624</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp nickname&nbsp id&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   625</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_nickname;</code></td></tr>
<tr><td><code><i>   626</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   627</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   628</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_PAGE_SELECT_LSB&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   629</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   630</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Page&nbsp select&nbsp LSB&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   631</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp (vscp_page_select&nbsp &&nbsp 0xff);</code></td></tr>
<tr><td><code><i>   632</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   633</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   634</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   635</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_PAGE_SELECT_MSB&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   636</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   637</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Page&nbsp select&nbsp MSB&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   638</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp (vscp_page_select&nbsp&rsaquo &rsaquo &nbsp 8)&nbsp &&nbsp 0xff;</code></td></tr>
<tr><td><code><i>   639</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   640</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   641</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_BOOT_LOADER_ALGORITHM&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   642</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Boot&nbsp loader&nbsp algorithm&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   643</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getBootLoaderAlgorithm();</code></td></tr>
<tr><td><code><i>   644</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   645</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_BUFFER_SIZE&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   646</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Buffer&nbsp size&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   647</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getBufferSize();</code></td></tr>
<tr><td><code><i>   648</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   649</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_PAGES_USED&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   650</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Register&nbsp Pages&nbsp Used&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   651</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getRegisterPagesUsed();</code></td></tr>
<tr><td><code><i>   652</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   653</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp ((reg&nbsp&rsaquo &nbsp (VSCP_REG_GUID&nbsp -&nbsp 1))&nbsp &&</code></td></tr>
<tr><td><code><i>   654</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (reg&nbsp&lsaquo &nbsp VSCP_REG_DEVICE_URL))&nbsp {</code></td></tr>
<tr><td><code><i>   655</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   656</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp GUID&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   657</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getGUID(reg&nbsp -&nbsp VSCP_REG_GUID);</code></td></tr>
<tr><td><code><i>   658</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   659</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   660</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   661</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   662</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp The&nbsp device&nbsp URL&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   663</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getMDF_URL(reg&nbsp -&nbsp VSCP_REG_DEVICE_URL);</code></td></tr>
<tr><td><code><i>   664</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   665</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   666</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   667</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp return&nbsp rv;</code></td></tr>
<tr><td><code><i>   668</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   669</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   670</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   671</i> </code></td><td><code>&nbsp //&nbsp vscp_writeRegister</code></td></tr>
<tr><td><code><i>   672</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   673</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   674</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_writeRegister(uint8_t&nbsp reg,&nbsp uint8_t&nbsp value)</code></td></tr>
<tr><td><code><i>   675</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   676</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (reg&nbsp&rsaquo  =&nbsp 0x80)&nbsp {</code></td></tr>
<tr><td><code><i>   677</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp return&nbsp vscp_writeStdReg(reg,&nbsp value);</code></td></tr>
<tr><td><code><i>   678</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   679</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp return&nbsp vscp_writeAppReg(reg,&nbsp value);</code></td></tr>
<tr><td><code><i>   680</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   681</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   682</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   683</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   684</i> </code></td><td><code>&nbsp //&nbsp vscp_writeStdReg</code></td></tr>
<tr><td><code><i>   685</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   686</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   687</i> </code></td><td><code>&nbsp uint8_t&nbsp vscp_writeStdReg(uint8_t&nbsp reg,&nbsp uint8_t&nbsp value)</code></td></tr>
<tr><td><code><i>   688</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   689</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp uint8_t&nbsp rv&nbsp =&nbsp ~value;</code></td></tr>
<tr><td><code><i>   690</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   691</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp ((reg&nbsp&rsaquo &nbsp (VSCP_REG_VSCP_MINOR_VERSION&nbsp +&nbsp 1))&nbsp &&</code></td></tr>
<tr><td><code><i>   692</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (reg&nbsp&lsaquo &nbsp VSCP_REG_MANUFACTUR_ID0))&nbsp {</code></td></tr>
<tr><td><code><i>   693</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   694</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp User&nbsp Client&nbsp ID&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   695</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_setUserID((reg&nbsp -&nbsp VSCP_REG_USERID0),&nbsp value);</code></td></tr>
<tr><td><code><i>   696</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getUserID((reg&nbsp -&nbsp VSCP_REG_USERID0));</code></td></tr>
<tr><td><code><i>   697</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   698</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   699</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_PAGE_SELECT_MSB&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   700</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   701</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Page&nbsp select&nbsp register&nbsp MSB&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   702</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_page_select&nbsp =&nbsp (vscp_page_select&nbsp &&nbsp 0xff)&nbsp |&nbsp ((uint16_t)&nbsp value&nbsp&lsaquo &lsaquo &nbsp 8);</code></td></tr>
<tr><td><code><i>   703</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp (vscp_page_select&nbsp&rsaquo &rsaquo &nbsp 8)&nbsp &&nbsp 0xff;</code></td></tr>
<tr><td><code><i>   704</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   705</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (VSCP_REG_PAGE_SELECT_LSB&nbsp ==&nbsp reg)&nbsp {</code></td></tr>
<tr><td><code><i>   706</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   707</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp *&nbsp *&nbsp *&nbsp Page&nbsp select&nbsp register&nbsp LSB&nbsp *&nbsp *&nbsp *</code></td></tr>
<tr><td><code><i>   708</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_page_select&nbsp =&nbsp (vscp_page_select&nbsp &&nbsp 0xff00)&nbsp |&nbsp value;</code></td></tr>
<tr><td><code><i>   709</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp (vscp_page_select&nbsp &&nbsp 0xff);</code></td></tr>
<tr><td><code><i>   710</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   711</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   712</i> </code></td><td><code>&nbsp #ifdef&nbsp ENABLE_WRITE_2PROTECTED_LOCATIONS</code></td></tr>
<tr><td><code><i>   713</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   714</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Write&nbsp manufacturer&nbsp id&nbsp configuration&nbsp information</code></td></tr>
<tr><td><code><i>   715</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp ((reg&nbsp&rsaquo &nbsp VSCP_REG_USERID4)&nbsp &&&nbsp (reg&nbsp&lsaquo &nbsp VSCP_REG_NICKNAME_ID))&nbsp {</code></td></tr>
<tr><td><code><i>   716</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp page&nbsp select&nbsp must&nbsp be&nbsp 0xffff&nbsp for&nbsp writes&nbsp to&nbsp be&nbsp possible</code></td></tr>
<tr><td><code><i>   717</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((0xff&nbsp !=&nbsp ((vscp_page_select&nbsp&rsaquo &rsaquo &nbsp 8)&nbsp &&nbsp 0xff))&nbsp ||</code></td></tr>
<tr><td><code><i>   718</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (0xff&nbsp !=&nbsp (vscp_page_select&nbsp &&nbsp 0xff)))&nbsp {</code></td></tr>
<tr><td><code><i>   719</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp return&nbsp complement&nbsp to&nbsp indicate&nbsp error</code></td></tr>
<tr><td><code><i>   720</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp ~value;</code></td></tr>
<tr><td><code><i>   721</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   722</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Write</code></td></tr>
<tr><td><code><i>   723</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_setManufacturerId(reg&nbsp -&nbsp VSCP_REG_MANUFACTUR_ID0,&nbsp value);</code></td></tr>
<tr><td><code><i>   724</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getManufacturerId(reg&nbsp -&nbsp VSCP_REG_MANUFACTUR_ID0);</code></td></tr>
<tr><td><code><i>   725</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   726</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Write&nbsp GUID&nbsp configuration&nbsp information</code></td></tr>
<tr><td><code><i>   727</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp ((reg&nbsp&rsaquo &nbsp (VSCP_REG_GUID&nbsp -&nbsp 1))&nbsp &&&nbsp (reg&nbsp&lsaquo &nbsp VSCP_REG_DEVICE_URL))&nbsp {</code></td></tr>
<tr><td><code><i>   728</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp page&nbsp must&nbsp be&nbsp 0xffff&nbsp for&nbsp writes&nbsp to&nbsp be&nbsp possible</code></td></tr>
<tr><td><code><i>   729</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((0xff&nbsp !=&nbsp ((vscp_page_select&nbsp&rsaquo &rsaquo &nbsp 8)&nbsp &&nbsp 0xff))&nbsp ||</code></td></tr>
<tr><td><code><i>   730</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (0xff&nbsp !=&nbsp (vscp_page_select&nbsp &&nbsp 0xff)))&nbsp {</code></td></tr>
<tr><td><code><i>   731</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp return&nbsp complement&nbsp to&nbsp indicate&nbsp error</code></td></tr>
<tr><td><code><i>   732</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp ~value;</code></td></tr>
<tr><td><code><i>   733</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   734</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_setGUID(reg&nbsp -&nbsp VSCP_REG_GUID,&nbsp value);</code></td></tr>
<tr><td><code><i>   735</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp vscp_getGUID(reg&nbsp -&nbsp VSCP_REG_GUID);</code></td></tr>
<tr><td><code><i>   736</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   737</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   738</i> </code></td><td><code>&nbsp #endif</code></td></tr>
<tr><td><code><i>   739</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (&nbsp (&nbsp reg&nbsp&rsaquo  =&nbsp VSCP_REG_STANDARD_DEVICE_FAMILY_CODE&nbsp )&nbsp &&</code></td></tr>
<tr><td><code><i>   740</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (&nbsp reg&nbsp&lsaquo &nbsp VSCP_REG_STANDARD_DEVICE_TYPE_CODE&nbsp )&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>   741</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   742</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint32_t&nbsp code&nbsp =&nbsp vscp_getFamilyCode();</code></td></tr>
<tr><td><code><i>   743</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp idx&nbsp =&nbsp reg&nbsp -&nbsp VSCP_REG_STANDARD_DEVICE_FAMILY_CODE;</code></td></tr>
<tr><td><code><i>   744</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp code&nbsp&rsaquo &rsaquo &nbsp (((3-idx)*8)&nbsp &&nbsp 0xff);&nbsp&nbsp&nbsp&nbsp&nbsp </code></td></tr>
<tr><td><code><i>   745</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   746</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (&nbsp (&nbsp reg&nbsp&rsaquo  =&nbsp VSCP_REG_STANDARD_DEVICE_TYPE_CODE&nbsp )&nbsp &&</code></td></tr>
<tr><td><code><i>   747</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (&nbsp reg&nbsp&lsaquo &nbsp VSCP_REG_DEFAULT_CONFIG_RESTORE&nbsp )&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>   748</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   749</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint32_t&nbsp code&nbsp =&nbsp vscp_getFamilyType();</code></td></tr>
<tr><td><code><i>   750</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp idx&nbsp =&nbsp reg&nbsp -&nbsp VSCP_REG_STANDARD_DEVICE_TYPE_CODE;</code></td></tr>
<tr><td><code><i>   751</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp code&nbsp&rsaquo &rsaquo &nbsp (((3-idx)*8)&nbsp &&nbsp 0xff);</code></td></tr>
<tr><td><code><i>   752</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   753</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (&nbsp VSCP_REG_DEFAULT_CONFIG_RESTORE&nbsp ==&nbsp reg&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>   754</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp 0x55&nbsp ==&nbsp value&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>   755</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_configtimer&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   756</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp 0x55;</code></td></tr>
<tr><td><code><i>   757</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   758</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp else&nbsp if&nbsp (&nbsp 0xaa&nbsp ==&nbsp value&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>   759</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp vscp_configtimer&nbsp&lsaquo &nbsp 1000&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>   760</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_restoreDefaults();</code></td></tr>
<tr><td><code><i>   761</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp 0xaa;&nbsp&nbsp&nbsp&nbsp&nbsp </code></td></tr>
<tr><td><code><i>   762</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   763</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   764</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp 0; //&nbsp false  </code></td></tr>
<tr><td><code><i>   765</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   766</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   767</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp </code></td></tr>
<tr><td><code><i>   768</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   769</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   770</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp return&nbsp complement&nbsp to&nbsp indicate&nbsp error</code></td></tr>
<tr><td><code><i>   771</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp rv&nbsp =&nbsp ~value;</code></td></tr>
<tr><td><code><i>   772</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   773</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   774</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp return&nbsp rv;</code></td></tr>
<tr><td><code><i>   775</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>   776</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   777</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>   778</i> </code></td><td><code>&nbsp //&nbsp vscp_writeStdReg</code></td></tr>
<tr><td><code><i>   779</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>   780</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   781</i> </code></td><td><code>&nbsp void&nbsp vscp_handleProtocolEvent(void)</code></td></tr>
<tr><td><code><i>   782</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>   783</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   784</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (VSCP_CLASS1_PROTOCOL&nbsp ==&nbsp vscp_imsg.vscp_class)&nbsp {</code></td></tr>
<tr><td><code><i>   785</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   786</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   787</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp switch&nbsp (vscp_imsg.vscp_type)&nbsp {</code></td></tr>
<tr><td><code><i>   788</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   789</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_SEGCTRL_HEARTBEAT:</code></td></tr>
<tr><td><code><i>   790</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   791</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_handleHeartbeat();</code></td></tr>
<tr><td><code><i>   792</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   793</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   794</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_NEW_NODE_ONLINE:</code></td></tr>
<tr><td><code><i>   795</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   796</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_newNodeOnline();</code></td></tr>
<tr><td><code><i>   797</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   798</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   799</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_SET_NICKNAME:</code></td></tr>
<tr><td><code><i>   800</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   801</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_handleSetNickname();</code></td></tr>
<tr><td><code><i>   802</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   803</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   804</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_DROP_NICKNAME:</code></td></tr>
<tr><td><code><i>   805</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   806</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_handleDropNickname();</code></td></tr>
<tr><td><code><i>   807</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   808</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   809</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_READ_REGISTER:</code></td></tr>
<tr><td><code><i>   810</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   811</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((2&nbsp ==&nbsp (vscp_imsg.flags&nbsp &&nbsp 0x0f))&nbsp &&</code></td></tr>
<tr><td><code><i>   812</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   813</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   814</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_imsg.data[&nbsp 1&nbsp ]&nbsp&lsaquo &nbsp 0x80)&nbsp {</code></td></tr>
<tr><td><code><i>   815</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   816</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Read&nbsp application&nbsp specific&nbsp register</code></td></tr>
<tr><td><code><i>   817</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 1&nbsp ]&nbsp =&nbsp vscp_readAppReg(vscp_imsg.data[&nbsp 1&nbsp ]);</code></td></tr>
<tr><td><code><i>   818</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   819</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Register&nbsp to&nbsp read</code></td></tr>
<tr><td><code><i>   820</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp vscp_imsg.data[&nbsp 1&nbsp ];</code></td></tr>
<tr><td><code><i>   821</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   822</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_MEDIUM;</code></td></tr>
<tr><td><code><i>   823</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 2;</code></td></tr>
<tr><td><code><i>   824</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>   825</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_RW_RESPONSE;</code></td></tr>
<tr><td><code><i>   826</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   827</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Send&nbsp reply&nbsp data</code></td></tr>
<tr><td><code><i>   828</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>   829</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   830</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   831</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Read&nbsp VSCP&nbsp register</code></td></tr>
<tr><td><code><i>   832</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 1&nbsp ]&nbsp =</code></td></tr>
<tr><td><code><i>   833</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_readStdReg(vscp_imsg.data[&nbsp 1&nbsp ]);</code></td></tr>
<tr><td><code><i>   834</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   835</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Register&nbsp to&nbsp read</code></td></tr>
<tr><td><code><i>   836</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp vscp_imsg.data[&nbsp 1&nbsp ];</code></td></tr>
<tr><td><code><i>   837</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   838</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_NORMAL;</code></td></tr>
<tr><td><code><i>   839</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 2;</code></td></tr>
<tr><td><code><i>   840</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>   841</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_RW_RESPONSE;</code></td></tr>
<tr><td><code><i>   842</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   843</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Send&nbsp event</code></td></tr>
<tr><td><code><i>   844</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>   845</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   846</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   847</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   848</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   849</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_WRITE_REGISTER:</code></td></tr>
<tr><td><code><i>   850</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   851</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((3&nbsp ==&nbsp (vscp_imsg.flags&nbsp &&nbsp 0x0f))&nbsp &&</code></td></tr>
<tr><td><code><i>   852</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   853</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   854</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_imsg.data[&nbsp 1&nbsp ]&nbsp&lsaquo &nbsp 0x80)&nbsp {</code></td></tr>
<tr><td><code><i>   855</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   856</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Write&nbsp application&nbsp specific&nbsp register</code></td></tr>
<tr><td><code><i>   857</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 1&nbsp ]&nbsp =</code></td></tr>
<tr><td><code><i>   858</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_writeAppReg(vscp_imsg.data[&nbsp 1&nbsp ],&nbsp vscp_imsg.data[&nbsp 2&nbsp ]);</code></td></tr>
<tr><td><code><i>   859</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   860</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Register&nbsp read</code></td></tr>
<tr><td><code><i>   861</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp vscp_imsg.data[&nbsp 1&nbsp ];</code></td></tr>
<tr><td><code><i>   862</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   863</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_MEDIUM;</code></td></tr>
<tr><td><code><i>   864</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 2;</code></td></tr>
<tr><td><code><i>   865</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>   866</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_RW_RESPONSE;</code></td></tr>
<tr><td><code><i>   867</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   868</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Send&nbsp reply</code></td></tr>
<tr><td><code><i>   869</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>   870</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   871</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>   872</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   873</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Write&nbsp VSCP&nbsp register</code></td></tr>
<tr><td><code><i>   874</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 1&nbsp ]&nbsp =</code></td></tr>
<tr><td><code><i>   875</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_writeStdReg(vscp_imsg.data[&nbsp 1&nbsp ],&nbsp vscp_imsg.data[&nbsp 2&nbsp ]);</code></td></tr>
<tr><td><code><i>   876</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   877</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Register&nbsp read</code></td></tr>
<tr><td><code><i>   878</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp vscp_imsg.data[&nbsp 1&nbsp ];</code></td></tr>
<tr><td><code><i>   879</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   880</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_MEDIUM;</code></td></tr>
<tr><td><code><i>   881</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 2;</code></td></tr>
<tr><td><code><i>   882</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>   883</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_RW_RESPONSE;</code></td></tr>
<tr><td><code><i>   884</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   885</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Write&nbsp event</code></td></tr>
<tr><td><code><i>   886</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>   887</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   888</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   889</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   890</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   891</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_ENTER_BOOT_LOADER:</code></td></tr>
<tr><td><code><i>   892</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   893</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (9&nbsp ==&nbsp vscp_imsg.data[&nbsp 1&nbsp ]))&nbsp //&nbsp AVR&nbsp algorithm&nbsp 0</code></td></tr>
<tr><td><code><i>   894</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp {</code></td></tr>
<tr><td><code><i>   895</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_goBootloaderMode();</code></td></tr>
<tr><td><code><i>   896</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   897</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   898</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   899</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (1&nbsp ==&nbsp vscp_imsg.data[&nbsp 1&nbsp ])&nbsp &&&nbsp //&nbsp microchip&nbsp PIC&nbsp algorithm</code></td></tr>
<tr><td><code><i>   900</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(0)&nbsp ==&nbsp vscp_imsg.data[&nbsp 2&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   901</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(3)&nbsp ==&nbsp vscp_imsg.data[&nbsp 3&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   902</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(5)&nbsp ==&nbsp vscp_imsg.data[&nbsp 4&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   903</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(7)&nbsp ==&nbsp vscp_imsg.data[&nbsp 5&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   904</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp ((vscp_page_select&nbsp&rsaquo &rsaquo &nbsp 8)&nbsp ==&nbsp vscp_imsg.data[&nbsp 6&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   905</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp ((vscp_page_select&nbsp &&nbsp 0xff)&nbsp ==&nbsp vscp_imsg.data[&nbsp 7&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   906</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   907</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_goBootloaderMode();</code></td></tr>
<tr><td><code><i>   908</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   909</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   910</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   911</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   912</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_RESET_DEVICE:</code></td></tr>
<tr><td><code><i>   913</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   914</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp switch&nbsp (vscp_imsg.data[&nbsp 0&nbsp ]&nbsp&rsaquo &rsaquo &nbsp 4)&nbsp {</code></td></tr>
<tr><td><code><i>   915</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   916</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp 0:</code></td></tr>
<tr><td><code><i>   917</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((vscp_getGUID(0)&nbsp ==&nbsp vscp_imsg.data[&nbsp 1&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   918</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(1)&nbsp ==&nbsp vscp_imsg.data[&nbsp 2&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   919</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(2)&nbsp ==&nbsp vscp_imsg.data[&nbsp 3&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   920</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(3)&nbsp ==&nbsp vscp_imsg.data[&nbsp 4&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   921</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_guid_reset&nbsp |=&nbsp 0x10;</code></td></tr>
<tr><td><code><i>   922</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   923</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   924</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   925</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp 1:</code></td></tr>
<tr><td><code><i>   926</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((vscp_getGUID(4)&nbsp ==&nbsp vscp_imsg.data[&nbsp 1&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   927</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(5)&nbsp ==&nbsp vscp_imsg.data[&nbsp 2&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   928</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(6)&nbsp ==&nbsp vscp_imsg.data[&nbsp 3&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   929</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(7)&nbsp ==&nbsp vscp_imsg.data[&nbsp 4&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   930</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_guid_reset&nbsp |=&nbsp 0x20;</code></td></tr>
<tr><td><code><i>   931</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   932</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   933</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   934</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp 2:</code></td></tr>
<tr><td><code><i>   935</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((vscp_getGUID(8)&nbsp ==&nbsp vscp_imsg.data[&nbsp 1&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   936</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(9)&nbsp ==&nbsp vscp_imsg.data[&nbsp 2&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   937</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(10)&nbsp ==&nbsp vscp_imsg.data[&nbsp 3&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   938</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(11)&nbsp ==&nbsp vscp_imsg.data[&nbsp 4&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   939</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_guid_reset&nbsp |=&nbsp 0x40;</code></td></tr>
<tr><td><code><i>   940</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   941</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   942</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   943</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp 3:</code></td></tr>
<tr><td><code><i>   944</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((vscp_getGUID(12)&nbsp ==&nbsp vscp_imsg.data[&nbsp 1&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   945</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(13)&nbsp ==&nbsp vscp_imsg.data[&nbsp 2&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   946</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(14)&nbsp ==&nbsp vscp_imsg.data[&nbsp 3&nbsp ])&nbsp &&</code></td></tr>
<tr><td><code><i>   947</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_getGUID(15)&nbsp ==&nbsp vscp_imsg.data[&nbsp 4&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>   948</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_guid_reset&nbsp |=&nbsp 0x80;</code></td></tr>
<tr><td><code><i>   949</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   950</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   951</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   952</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp default:</code></td></tr>
<tr><td><code><i>   953</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_guid_reset&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   954</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   955</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   956</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   957</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (0xf0&nbsp ==&nbsp (vscp_guid_reset&nbsp &&nbsp 0xf0))&nbsp {</code></td></tr>
<tr><td><code><i>   958</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Do&nbsp a&nbsp reset</code></td></tr>
<tr><td><code><i>   959</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_init();</code></td></tr>
<tr><td><code><i>   960</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   961</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   962</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   963</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_PAGE_READ:</code></td></tr>
<tr><td><code><i>   964</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   965</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ])&nbsp {</code></td></tr>
<tr><td><code><i>   966</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   967</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp i;</code></td></tr>
<tr><td><code><i>   968</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp pos&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>   969</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp offset&nbsp =&nbsp vscp_imsg.data[&nbsp 1&nbsp ];</code></td></tr>
<tr><td><code><i>   970</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp len&nbsp =&nbsp vscp_imsg.data[&nbsp 2&nbsp ];</code></td></tr>
<tr><td><code><i>   971</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   972</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp for&nbsp (i&nbsp =&nbsp 0;&nbsp i&nbsp&lsaquo &nbsp len;&nbsp i++)&nbsp {</code></td></tr>
<tr><td><code><i>   973</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp (i&nbsp %&nbsp 7)&nbsp +&nbsp 1&nbsp ]&nbsp =&nbsp vscp_readRegister(offset&nbsp +&nbsp i);</code></td></tr>
<tr><td><code><i>   974</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   975</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((i&nbsp %&nbsp 7)&nbsp ==&nbsp 6&nbsp ||&nbsp i&nbsp ==&nbsp (len&nbsp -&nbsp 1))&nbsp {</code></td></tr>
<tr><td><code><i>   976</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp bytes;</code></td></tr>
<tr><td><code><i>   977</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   978</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((i&nbsp %&nbsp 7)&nbsp ==&nbsp 6)&nbsp bytes&nbsp =&nbsp 7;</code></td></tr>
<tr><td><code><i>   979</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp else&nbsp bytes&nbsp =&nbsp (i&nbsp %&nbsp 7)&nbsp +&nbsp 1;</code></td></tr>
<tr><td><code><i>   980</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   981</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp bytes&nbsp +&nbsp 1;</code></td></tr>
<tr><td><code><i>   982</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_NORMAL;</code></td></tr>
<tr><td><code><i>   983</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>   984</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_RW_PAGE_RESPONSE;</code></td></tr>
<tr><td><code><i>   985</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp pos;&nbsp //&nbsp index</code></td></tr>
<tr><td><code><i>   986</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   987</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp the&nbsp event</code></td></tr>
<tr><td><code><i>   988</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>   989</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp pos++;</code></td></tr>
<tr><td><code><i>   990</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   991</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   992</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>   993</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>   994</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   995</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_PAGE_WRITE:</code></td></tr>
<tr><td><code><i>   996</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>   997</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ])&nbsp {</code></td></tr>
<tr><td><code><i>   998</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp i;</code></td></tr>
<tr><td><code><i>   999</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp pos&nbsp =&nbsp vscp_imsg.data[&nbsp 1&nbsp ];</code></td></tr>
<tr><td><code><i>  1000</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp len&nbsp =&nbsp (vscp_imsg.flags&nbsp -&nbsp 2)&nbsp &&nbsp 0x07;</code></td></tr>
<tr><td><code><i>  1001</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1002</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp for&nbsp (i&nbsp =&nbsp 0;&nbsp i&nbsp&lsaquo &nbsp len;&nbsp i++)&nbsp {</code></td></tr>
<tr><td><code><i>  1003</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Write&nbsp VSCP&nbsp register</code></td></tr>
<tr><td><code><i>  1004</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_writeRegister(pos&nbsp +&nbsp i,&nbsp vscp_imsg.data[&nbsp 2&nbsp +&nbsp i&nbsp ]);</code></td></tr>
<tr><td><code><i>  1005</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 1&nbsp +&nbsp i&nbsp ]&nbsp =&nbsp vscp_readRegister(pos&nbsp +&nbsp i);</code></td></tr>
<tr><td><code><i>  1006</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1007</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1008</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_NORMAL;</code></td></tr>
<tr><td><code><i>  1009</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>  1010</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_RW_PAGE_RESPONSE;</code></td></tr>
<tr><td><code><i>  1011</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp 0;&nbsp //&nbsp index</code></td></tr>
<tr><td><code><i>  1012</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp len&nbsp +&nbsp 1;</code></td></tr>
<tr><td><code><i>  1013</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1014</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp the&nbsp event</code></td></tr>
<tr><td><code><i>  1015</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>  1016</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1017</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1018</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>  1019</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1020</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_INCREMENT_REGISTER:</code></td></tr>
<tr><td><code><i>  1021</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1022</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ])&nbsp {</code></td></tr>
<tr><td><code><i>  1023</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1024</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 1&nbsp ]&nbsp =&nbsp vscp_writeAppReg(</code></td></tr>
<tr><td><code><i>  1025</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_imsg.data[&nbsp 1&nbsp ],</code></td></tr>
<tr><td><code><i>  1026</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_readAppReg(vscp_imsg.data[&nbsp 1&nbsp ])&nbsp +&nbsp 1);</code></td></tr>
<tr><td><code><i>  1027</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1028</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp vscp_imsg.data[&nbsp 1&nbsp ];</code></td></tr>
<tr><td><code><i>  1029</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1030</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_NORMAL;</code></td></tr>
<tr><td><code><i>  1031</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 2;</code></td></tr>
<tr><td><code><i>  1032</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>  1033</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_RW_RESPONSE;</code></td></tr>
<tr><td><code><i>  1034</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1035</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp the&nbsp event</code></td></tr>
<tr><td><code><i>  1036</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>  1037</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1038</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>  1039</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1040</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_DECREMENT_REGISTER:</code></td></tr>
<tr><td><code><i>  1041</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1042</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ])&nbsp {</code></td></tr>
<tr><td><code><i>  1043</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1044</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 1&nbsp ]&nbsp =&nbsp vscp_writeAppReg(</code></td></tr>
<tr><td><code><i>  1045</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_imsg.data[&nbsp 1&nbsp ],</code></td></tr>
<tr><td><code><i>  1046</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_readAppReg(vscp_imsg.data[&nbsp 1&nbsp ])&nbsp -&nbsp 1);</code></td></tr>
<tr><td><code><i>  1047</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1048</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 0&nbsp ]&nbsp =&nbsp vscp_imsg.data[&nbsp 1&nbsp ];</code></td></tr>
<tr><td><code><i>  1049</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1050</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_NORMAL;</code></td></tr>
<tr><td><code><i>  1051</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 2;</code></td></tr>
<tr><td><code><i>  1052</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>  1053</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_RW_RESPONSE;</code></td></tr>
<tr><td><code><i>  1054</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1055</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp the&nbsp event</code></td></tr>
<tr><td><code><i>  1056</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>  1057</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1058</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>  1059</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1060</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_WHO_IS_THERE:</code></td></tr>
<tr><td><code><i>  1061</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1062</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp ((vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ])&nbsp ||</code></td></tr>
<tr><td><code><i>  1063</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (0xff&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ]))&nbsp {</code></td></tr>
<tr><td><code><i>  1064</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1065</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp i,&nbsp j,&nbsp k&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>  1066</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1067</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Send&nbsp data</code></td></tr>
<tr><td><code><i>  1068</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1069</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_NORMAL;</code></td></tr>
<tr><td><code><i>  1070</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 8;</code></td></tr>
<tr><td><code><i>  1071</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>  1072</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_WHO_IS_THERE_RESPONSE;</code></td></tr>
<tr><td><code><i>  1073</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1074</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp for&nbsp (i&nbsp =&nbsp 0;&nbsp i&nbsp&lsaquo &nbsp 3;&nbsp i++)&nbsp //&nbsp fill&nbsp up&nbsp with&nbsp GUID</code></td></tr>
<tr><td><code><i>  1075</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp {</code></td></tr>
<tr><td><code><i>  1076</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[0]&nbsp =&nbsp i;</code></td></tr>
<tr><td><code><i>  1077</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1078</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp for&nbsp (j&nbsp =&nbsp 1;&nbsp j&nbsp&lsaquo &nbsp 8;&nbsp j++)&nbsp {</code></td></tr>
<tr><td><code><i>  1079</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[j]&nbsp =&nbsp vscp_getGUID(15&nbsp -&nbsp k++);</code></td></tr>
<tr><td><code><i>  1080</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (k&nbsp&rsaquo &nbsp 16)</code></td></tr>
<tr><td><code><i>  1081</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>  1082</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1083</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1084</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (k&nbsp&rsaquo &nbsp 16)</code></td></tr>
<tr><td><code><i>  1085</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>  1086</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1087</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>  1088</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1089</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1090</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp for&nbsp (j&nbsp =&nbsp 0;&nbsp j&nbsp&lsaquo &nbsp 5;&nbsp j++)&nbsp //&nbsp fillup&nbsp previous&nbsp event&nbsp with&nbsp MDF</code></td></tr>
<tr><td><code><i>  1091</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp {</code></td></tr>
<tr><td><code><i>  1092</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_getMDF_URL(j)&nbsp&rsaquo &nbsp 0)</code></td></tr>
<tr><td><code><i>  1093</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[3&nbsp +&nbsp j]&nbsp =&nbsp vscp_getMDF_URL(j);</code></td></tr>
<tr><td><code><i>  1094</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp else</code></td></tr>
<tr><td><code><i>  1095</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[3&nbsp +&nbsp j]&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>  1096</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1097</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1098</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>  1099</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1100</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp k&nbsp =&nbsp 5;&nbsp //&nbsp start&nbsp offset</code></td></tr>
<tr><td><code><i>  1101</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp for&nbsp (i&nbsp =&nbsp 3;&nbsp i&nbsp&lsaquo &nbsp 7;&nbsp i++)&nbsp //&nbsp fill&nbsp up&nbsp with&nbsp the&nbsp rest&nbsp of&nbsp GUID</code></td></tr>
<tr><td><code><i>  1102</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp {</code></td></tr>
<tr><td><code><i>  1103</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[0]&nbsp =&nbsp i;</code></td></tr>
<tr><td><code><i>  1104</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1105</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp for&nbsp (j&nbsp =&nbsp 1;&nbsp j&nbsp&lsaquo &nbsp 8;&nbsp j++)&nbsp {</code></td></tr>
<tr><td><code><i>  1106</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[j]&nbsp =&nbsp vscp_getMDF_URL(k++);</code></td></tr>
<tr><td><code><i>  1107</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1108</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>  1109</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1110</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1111</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1112</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>  1113</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1114</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1115</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_GET_MATRIX_INFO:</code></td></tr>
<tr><td><code><i>  1116</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1117</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ])&nbsp {</code></td></tr>
<tr><td><code><i>  1118</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1119</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_NORMAL;</code></td></tr>
<tr><td><code><i>  1120</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 7;</code></td></tr>
<tr><td><code><i>  1121</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>  1122</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_GET_MATRIX_INFO_RESPONSE;</code></td></tr>
<tr><td><code><i>  1123</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1124</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_getMatrixInfo((char&nbsp *)&nbsp vscp_omsg.data);</code></td></tr>
<tr><td><code><i>  1125</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1126</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp the&nbsp event</code></td></tr>
<tr><td><code><i>  1127</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>  1128</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1129</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>  1130</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1131</i> </code></td><td><code>&nbsp #ifdef&nbsp EMBEDDED_MDF</code></td></tr>
<tr><td><code><i>  1132</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_GET_EMBEDDED_MDF:</code></td></tr>
<tr><td><code><i>  1133</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1134</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_getEmbeddedMdfInfo();</code></td></tr>
<tr><td><code><i>  1135</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>  1136</i> </code></td><td><code>&nbsp #endif</code></td></tr>
<tr><td><code><i>  1137</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1138</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_EXTENDED_PAGE_READ:</code></td></tr>
<tr><td><code><i>  1139</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1140</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp vscp_nickname&nbsp ==&nbsp vscp_imsg.data[0]&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>  1141</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1142</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint16_t&nbsp page_save;</code></td></tr>
<tr><td><code><i>  1143</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp byte&nbsp =&nbsp 0,&nbsp bytes&nbsp =&nbsp 0;</code></td></tr>
<tr><td><code><i>  1144</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp bytes_this_time,&nbsp cb;</code></td></tr>
<tr><td><code><i>  1145</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1146</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp if&nbsp data&nbsp byte&nbsp 4&nbsp of&nbsp the&nbsp request&nbsp is&nbsp present&nbsp probably&nbsp more&nbsp than&nbsp 1&nbsp register&nbsp should&nbsp be</code></td></tr>
<tr><td><code><i>  1147</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp read/written,&nbsp therefore&nbsp check&nbsp lower&nbsp 4&nbsp bits&nbsp of&nbsp the&nbsp flags&nbsp and&nbsp decide</code></td></tr>
<tr><td><code><i>  1148</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp (&nbsp vscp_imsg.flags&nbsp &&nbsp 0x0f)&nbsp&rsaquo &nbsp 3&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>  1149</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1150</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Number&nbsp of&nbsp registers&nbsp was&nbsp specified',&nbsp thus&nbsp take&nbsp that&nbsp value</code></td></tr>
<tr><td><code><i>  1151</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp bytes&nbsp =&nbsp vscp_imsg.data[4];</code></td></tr>
<tr><td><code><i>  1152</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp if&nbsp number&nbsp of&nbsp bytes&nbsp was&nbsp zero&nbsp we&nbsp read&nbsp one&nbsp byte&nbsp </code></td></tr>
<tr><td><code><i>  1153</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp 0&nbsp ==&nbsp bytes&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>  1154</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp bytes&nbsp =&nbsp 1;</code></td></tr>
<tr><td><code><i>  1155</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp </code></td></tr>
<tr><td><code><i>  1156</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1157</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>  1158</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp bytes&nbsp =&nbsp 1;</code></td></tr>
<tr><td><code><i>  1159</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1160</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1161</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Save&nbsp the&nbsp current&nbsp page</code></td></tr>
<tr><td><code><i>  1162</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp page_save&nbsp =&nbsp vscp_page_select;</code></td></tr>
<tr><td><code><i>  1163</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1164</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Assign&nbsp the&nbsp requested&nbsp page,&nbsp this&nbsp variable&nbsp is&nbsp used&nbsp in&nbsp the&nbsp implementation</code></td></tr>
<tr><td><code><i>  1165</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp specific&nbsp function&nbsp 'vscp_readAppReg()'&nbsp and&nbsp 'vscp_writeAppReg()'&nbsp to&nbsp actually</code></td></tr>
<tr><td><code><i>  1166</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp switch&nbsp pages&nbsp there</code></td></tr>
<tr><td><code><i>  1167</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_page_select&nbsp =&nbsp ((vscp_imsg.data[1]&nbsp&lsaquo &lsaquo &nbsp 8)&nbsp |&nbsp vscp_imsg.data[2]);</code></td></tr>
<tr><td><code><i>  1168</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1169</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Construct&nbsp response&nbsp event</code></td></tr>
<tr><td><code><i>  1170</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_NORMAL;</code></td></tr>
<tr><td><code><i>  1171</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>  1172</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_EXTENDED_PAGE_RESPONSE;</code></td></tr>
<tr><td><code><i>  1173</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[0]&nbsp =&nbsp 0;&nbsp //&nbsp index&nbsp of&nbsp event,&nbsp this&nbsp is&nbsp the&nbsp first</code></td></tr>
<tr><td><code><i>  1174</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[1]&nbsp =&nbsp vscp_imsg.data[1];&nbsp //&nbsp mirror&nbsp page&nbsp msb</code></td></tr>
<tr><td><code><i>  1175</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[2]&nbsp =&nbsp vscp_imsg.data[2];&nbsp //&nbsp mirror&nbsp page&nbsp lsb</code></td></tr>
<tr><td><code><i>  1176</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1177</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp do&nbsp {</code></td></tr>
<tr><td><code><i>  1178</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp calculate&nbsp bytes&nbsp to&nbsp transfer&nbsp in&nbsp this&nbsp event</code></td></tr>
<tr><td><code><i>  1179</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp (&nbsp bytes&nbsp -&nbsp byte&nbsp )&nbsp&rsaquo  =&nbsp 4&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>  1180</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp bytes_this_time&nbsp =&nbsp 4;</code></td></tr>
<tr><td><code><i>  1181</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp </code></td></tr>
<tr><td><code><i>  1182</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp else&nbsp {</code></td></tr>
<tr><td><code><i>  1183</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp bytes_this_time&nbsp =&nbsp (bytes&nbsp -&nbsp byte);</code></td></tr>
<tr><td><code><i>  1184</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1185</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1186</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp define&nbsp length&nbsp of&nbsp this&nbsp event</code></td></tr>
<tr><td><code><i>  1187</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 4&nbsp +&nbsp bytes_this_time;</code></td></tr>
<tr><td><code><i>  1188</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[3]&nbsp =</code></td></tr>
<tr><td><code><i>  1189</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_imsg.data[3]&nbsp +&nbsp byte;&nbsp //&nbsp first&nbsp register&nbsp in&nbsp this&nbsp event</code></td></tr>
<tr><td><code><i>  1190</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1191</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Put&nbsp up&nbsp to&nbsp four&nbsp registers&nbsp to&nbsp data&nbsp space</code></td></tr>
<tr><td><code><i>  1192</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp for&nbsp (&nbsp cb&nbsp =&nbsp 0;&nbsp cb&nbsp&lsaquo &nbsp bytes_this_time;&nbsp cb++&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>  1193</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp (4&nbsp +&nbsp cb)&nbsp ]&nbsp =</code></td></tr>
<tr><td><code><i>  1194</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_readRegister(&nbsp (&nbsp vscp_imsg.data[3]&nbsp +&nbsp byte&nbsp +&nbsp cb&nbsp )&nbsp );</code></td></tr>
<tr><td><code><i>  1195</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1196</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1197</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp the&nbsp event</code></td></tr>
<tr><td><code><i>  1198</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>  1199</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1200</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp increment&nbsp byte&nbsp by&nbsp bytes_this_time&nbsp and&nbsp the&nbsp event&nbsp number&nbsp by&nbsp one</code></td></tr>
<tr><td><code><i>  1201</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp byte&nbsp +=&nbsp bytes_this_time;</code></td></tr>
<tr><td><code><i>  1202</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1203</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp increment&nbsp the&nbsp index</code></td></tr>
<tr><td><code><i>  1204</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[0]&nbsp +=&nbsp 1;</code></td></tr>
<tr><td><code><i>  1205</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp </code></td></tr>
<tr><td><code><i>  1206</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp while&nbsp (byte&nbsp&lsaquo &nbsp bytes);</code></td></tr>
<tr><td><code><i>  1207</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1208</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Restore&nbsp the&nbsp saved&nbsp page</code></td></tr>
<tr><td><code><i>  1209</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_page_select&nbsp =&nbsp page_save;</code></td></tr>
<tr><td><code><i>  1210</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1211</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1212</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>  1213</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1214</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp case&nbsp VSCP_TYPE_PROTOCOL_EXTENDED_PAGE_WRITE:</code></td></tr>
<tr><td><code><i>  1215</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1216</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp vscp_nickname&nbsp ==&nbsp vscp_imsg.data[&nbsp 0&nbsp ]&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>  1217</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1218</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint8_t&nbsp i;</code></td></tr>
<tr><td><code><i>  1219</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp uint16_t&nbsp page_save;</code></td></tr>
<tr><td><code><i>  1220</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1221</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Save&nbsp the&nbsp current&nbsp page</code></td></tr>
<tr><td><code><i>  1222</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp page_save&nbsp =&nbsp vscp_page_select;</code></td></tr>
<tr><td><code><i>  1223</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1224</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Assign&nbsp the&nbsp requested&nbsp page</code></td></tr>
<tr><td><code><i>  1225</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp specific&nbsp function&nbsp 'vscp_readAppReg()'&nbsp and&nbsp 'vscp_writeAppReg()'&nbsp to&nbsp actually</code></td></tr>
<tr><td><code><i>  1226</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_page_select&nbsp =&nbsp (vscp_imsg.data[1]&nbsp&lsaquo &lsaquo &nbsp 8)&nbsp |&nbsp vscp_imsg.data[2];</code></td></tr>
<tr><td><code><i>  1227</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1228</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp for&nbsp (i&nbsp =&nbsp vscp_imsg.data[&nbsp 3&nbsp ];&nbsp //&nbsp register&nbsp to&nbsp write</code></td></tr>
<tr><td><code><i>  1229</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp number&nbsp of&nbsp registers&nbsp to&nbsp write&nbsp comes&nbsp from&nbsp byte&nbsp length&nbsp of&nbsp write&nbsp event</code></td></tr>
<tr><td><code><i>  1230</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp reduced&nbsp by&nbsp four&nbsp bytes</code></td></tr>
<tr><td><code><i>  1231</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp i&nbsp&lsaquo &nbsp (vscp_imsg.data[&nbsp 3&nbsp ]&nbsp +&nbsp ((vscp_imsg.flags&nbsp &&nbsp 0x0f)&nbsp -&nbsp 4));</code></td></tr>
<tr><td><code><i>  1232</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp i++)&nbsp {</code></td></tr>
<tr><td><code><i>  1233</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[&nbsp 4&nbsp +&nbsp (i&nbsp -&nbsp vscp_imsg.data[&nbsp 3&nbsp ])&nbsp ]&nbsp =</code></td></tr>
<tr><td><code><i>  1234</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_writeRegister(i,&nbsp vscp_imsg.data[&nbsp 4&nbsp +&nbsp (i&nbsp -&nbsp vscp_imsg.data[&nbsp 3&nbsp ])&nbsp ]);</code></td></tr>
<tr><td><code><i>  1235</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1236</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1237</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Restore&nbsp the&nbsp saved&nbsp page</code></td></tr>
<tr><td><code><i>  1238</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_page_select&nbsp =&nbsp page_save;</code></td></tr>
<tr><td><code><i>  1239</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1240</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority&nbsp =&nbsp VSCP_PRIORITY_NORMAL;</code></td></tr>
<tr><td><code><i>  1241</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.flags&nbsp =&nbsp VSCP_VALID_MSG&nbsp +&nbsp 4&nbsp +&nbsp ((vscp_imsg.flags&nbsp &&nbsp 0x0f)&nbsp -&nbsp 4);</code></td></tr>
<tr><td><code><i>  1242</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_class&nbsp =&nbsp VSCP_CLASS1_PROTOCOL;</code></td></tr>
<tr><td><code><i>  1243</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type&nbsp =&nbsp VSCP_TYPE_PROTOCOL_EXTENDED_PAGE_RESPONSE;</code></td></tr>
<tr><td><code><i>  1244</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[0]&nbsp =&nbsp 0;&nbsp //&nbsp index&nbsp of&nbsp event,&nbsp this&nbsp is&nbsp the&nbsp first&nbsp and&nbsp only</code></td></tr>
<tr><td><code><i>  1245</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[1]&nbsp =&nbsp vscp_imsg.data[1];&nbsp //&nbsp mirror&nbsp page&nbsp msb</code></td></tr>
<tr><td><code><i>  1246</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[2]&nbsp =&nbsp vscp_imsg.data[2];&nbsp //&nbsp mirror&nbsp page&nbsp lsb</code></td></tr>
<tr><td><code><i>  1247</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data[3]&nbsp =&nbsp vscp_imsg.data[3];&nbsp //&nbsp Register</code></td></tr>
<tr><td><code><i>  1248</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1249</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp send&nbsp the&nbsp event</code></td></tr>
<tr><td><code><i>  1250</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_sendEvent();</code></td></tr>
<tr><td><code><i>  1251</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1252</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1253</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>  1254</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1255</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1256</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp default:</code></td></tr>
<tr><td><code><i>  1257</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp //&nbsp Do&nbsp work&nbsp load</code></td></tr>
<tr><td><code><i>  1258</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp break;</code></td></tr>
<tr><td><code><i>  1259</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1260</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp }&nbsp //&nbsp switch</code></td></tr>
<tr><td><code><i>  1261</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1262</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }&nbsp //&nbsp CLASS1.PROTOCOL&nbsp event</code></td></tr>
<tr><td><code><i>  1263</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1264</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>  1265</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1266</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1267</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>  1268</i> </code></td><td><code>&nbsp //&nbsp vscp_sendEvent</code></td></tr>
<tr><td><code><i>  1269</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>  1270</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1271</i> </code></td><td><code>&nbsp int8_t&nbsp vscp_sendEvent(void)</code></td></tr>
<tr><td><code><i>  1272</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>  1273</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp int8_t&nbsp rv;</code></td></tr>
<tr><td><code><i>  1274</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1275</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (&nbsp !(rv&nbsp =&nbsp sendVSCPFrame(&nbsp vscp_omsg.vscp_class,</code></td></tr>
<tr><td><code><i>  1276</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.vscp_type,</code></td></tr>
<tr><td><code><i>  1277</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_nickname,</code></td></tr>
<tr><td><code><i>  1278</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.priority,</code></td></tr>
<tr><td><code><i>  1279</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp (vscp_omsg.flags&nbsp &&nbsp 0x0f),</code></td></tr>
<tr><td><code><i>  1280</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_omsg.data&nbsp )&nbsp )&nbsp )&nbsp {</code></td></tr>
<tr><td><code><i>  1281</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_errorcnt++;</code></td></tr>
<tr><td><code><i>  1282</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1283</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1284</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp return&nbsp rv;</code></td></tr>
<tr><td><code><i>  1285</i> </code></td><td><code>&nbsp }</code></td></tr>
<tr><td><code><i>  1286</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1287</i> </code></td><td><code>&nbsp ///////////////////////////////////////////////////////////////////////////////</code></td></tr>
<tr><td><code><i>  1288</i> </code></td><td><code>&nbsp //&nbsp vscp_getEvent</code></td></tr>
<tr><td><code><i>  1289</i> </code></td><td><code>&nbsp //</code></td></tr>
<tr><td><code><i>  1290</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1291</i> </code></td><td><code>&nbsp int8_t&nbsp vscp_getEvent(void)</code></td></tr>
<tr><td><code><i>  1292</i> </code></td><td><code>&nbsp {</code></td></tr>
<tr><td><code><i>  1293</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp int8_t&nbsp rv;</code></td></tr>
<tr><td><code><i>  1294</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1295</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1296</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp Dont&nbsp read&nbsp in&nbsp new&nbsp event&nbsp if&nbsp there&nbsp already&nbsp is&nbsp an&nbsp event</code></td></tr>
<tr><td><code><i>  1297</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp in&nbsp the&nbsp input&nbsp buffer.&nbsp We&nbsp return&nbsp TRUE&nbsp though&nbsp to&nbsp indicate&nbsp there&nbsp is</code></td></tr>
<tr><td><code><i>  1298</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp //&nbsp a&nbsp valid&nbsp event.</code></td></tr>
<tr><td><code><i>  1299</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp (vscp_imsg.flags&nbsp &&nbsp VSCP_VALID_MSG)&nbsp return&nbsp TRUE;</code></td></tr>
<tr><td><code><i>  1300</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1301</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1302</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp if&nbsp ((rv&nbsp =&nbsp getVSCPFrame(&vscp_imsg.vscp_class,</code></td></tr>
<tr><td><code><i>  1303</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &vscp_imsg.vscp_type,</code></td></tr>
<tr><td><code><i>  1304</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &vscp_imsg.oaddr,</code></td></tr>
<tr><td><code><i>  1305</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &vscp_imsg.priority,</code></td></tr>
<tr><td><code><i>  1306</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp &vscp_imsg.flags,</code></td></tr>
<tr><td><code><i>  1307</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_imsg.data)))&nbsp {</code></td></tr>
<tr><td><code><i>  1308</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1309</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp vscp_imsg.flags&nbsp |=&nbsp VSCP_VALID_MSG;</code></td></tr>
<tr><td><code><i>  1310</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp }</code></td></tr>
<tr><td><code><i>  1311</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1312</i> </code></td><td><code>&nbsp &nbsp&nbsp&nbsp&nbsp return&nbsp rv;</code></td></tr>
<tr><td><code><i>  1313</i> </code></td><td><code>&nbsp </code></td></tr>
<tr><td><code><i>  1314</i> </code></td><td><code>&nbsp }</code></code></BODY>
</HTML>
